<template>
  <div class="body text-capitalize">
    <div class="loading">
      <svg width="591" height="186" viewBox="0 0 591 186" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M18 90C13.1885 90.8019 2 95.6007 2 86C2 82.1481 2 78.2963 2 74.4444C2 69.4362 4.99682 67.8938 7.5 64C13.8392 54.1391 34.8933 53.6069 45 55.4444C52.0885 56.7333 59.0095 58.2107 65.9444 59.9444C68.5008 60.5835 75.2571 62.1356 76.8333 64.5C85.2832 77.1748 66.5617 97 54.4444 97C47.3155 97 44.9103 95.4274 42.5 89C40.6738 84.1302 38 78.7943 38 73.5556C38 71.3704 38 69.1852 38 67C38 62.4954 35.2484 59.379 37 55"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path d="M37 55V184" stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M108 63C108 74.9428 109.364 87.7643 107.444 99.5556C105.313 112.65 103.006 126.073 99.5556 138.889C97.3631 147.032 96.6904 155.269 94.2222 163.222C92.8153 167.756 92 175.192 92 180"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M105 66C109.156 70.1563 112.058 76.6673 115 81.7778C119.077 88.859 123.25 95.8114 127.333 102.889C134.759 115.761 143.895 127.901 150.389 141.389C152.764 146.322 155.577 150.155 158 155C158.376 155.752 162.119 160.898 160 158.556C156.334 154.504 152.976 149.804 149.5 145.556C146.013 141.294 138.558 140.056 133.556 138.056C130.619 136.881 127.836 135.862 125 134.444C121.53 132.709 119.388 129.055 115.556 127.778C108.338 125.372 102.106 117.226 94.5 116.056C89.9211 115.351 84.8728 112.582 81 110"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M202 66C201.797 64.3741 193.076 62.7832 191.5 62.0556C187.42 60.1724 184.081 59 179.611 59C169.532 59 159.62 64.3133 156.889 74.5556C153.701 86.5108 152.419 101.599 154.222 114.222C155.744 124.873 164.399 140.994 174.444 145.778C188.714 152.573 222.623 141.944 215.5 122C214.006 117.817 211.167 114 208 111C205.498 108.629 200.373 105.198 197 105C194.072 104.828 181.153 103.693 180 106"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M231 94C231.18 92.5589 245.899 92.7084 248.556 92C254.151 90.5079 259.546 87.7818 264.889 85.5556C269.165 83.7737 277.587 78.4374 278.889 73.5556C285.214 49.8377 254.249 50.8625 242.556 62.5556C231.678 73.433 222.823 97.5791 233.222 111.444C239.175 119.381 243.768 120 252.778 120C261.505 120 265.074 116.389 270 109"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M355 25C345.993 25.5298 335.184 24.3715 328.556 31C318.045 41.5109 338.694 50.4048 347.5 43.5556C348.826 42.5243 350.878 43.3161 351 41C351.138 38.387 351.205 35.545 350.944 32.9444C350.296 26.4608 344.714 23.1159 339.222 21.2222C328.999 17.6969 321.152 19.7151 312.5 26.4444C301.641 34.8903 301 52.5353 301 65.5556C301 74.3356 298.935 85.4653 302.611 93.6667C305.81 100.802 311.365 111.069 317 116.556C328.366 127.622 343.468 124.844 355.444 118C360.064 115.36 360.429 109.002 362.556 104.444C364.577 100.113 365 97.6776 365 93"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M399 53C386.632 65.3683 381.414 82.3815 384.944 99.4444C386.367 106.321 390.297 112 398 112C402.095 112 406.279 112.898 409.222 110.222C418.395 101.884 418.783 86.6001 417.944 74.4444C417.386 66.3485 413.035 59.4382 406.222 55.4444C402.683 53.3697 397.079 58 393 58"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M436 56C436 69.2955 438.245 82.1779 442 94.9444C444.101 102.087 444.679 109.715 446.222 117C446.782 119.642 447.716 122.306 448 125C448.27 127.565 447.399 119.873 446.944 117.333C445.193 107.556 445.486 97.9874 444.444 88.1667C443.481 79.0863 440.423 70.5269 438 61.7778C437.085 58.4735 436.667 54.9174 436.056 51.5556C435.313 47.4725 439.618 51.1065 441.444 51.7778C447.786 54.1091 458.767 54.1585 465.444 52.9444C466.382 52.7741 468.821 51.0258 469.778 52.2222C471.344 54.1795 467.255 67.7139 467.056 70.1111C464.771 97.5285 461.452 121.924 470.556 148.778C474.239 159.645 478.346 157.827 486 154"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <path
          d="M496.055 28.3811C496.055 40.0693 499.197 51.2261 501.915 62.516C503.176 67.7525 503.687 73.1899 504.655 78.486C505.497 83.0902 504.544 87.7397 505.645 92.3367C507 97.9973 505.867 103.95 507.167 109.442C507.609 111.312 508.384 113.854 508.384 115.611C508.384 123.759 519.873 121.851 525.204 121.703C529.581 121.582 534.212 118.046 538.219 116.632C543.313 114.835 546.11 112.153 548.798 107.55C556.232 94.8182 561.62 79.7149 557.665 64.6352C556.191 59.0181 554.758 53.7899 551.538 48.8923C547.073 42.1019 543.255 38.9663 536.202 34.928C532.068 32.561 528.409 32.4972 524.063 31.7113C519.669 30.9169 515.046 28.3811 510.592 28.3811C505.475 28.3811 498.753 27.1715 494 29.0623"
          stroke="white" stroke-width="3" stroke-linecap="round" />
        <!-- <path d="M497 3C497 20.1587 501.587 36.5372 505.556 53.1111C507.396 60.7985 508.142 68.7807 509.556 76.5556C510.784 83.3146 509.393 90.1403 511 96.8889C512.979 105.199 511.325 113.937 513.222 122C513.868 124.746 515 128.478 515 131.056C515 143.018 531.772 140.216 539.556 140C545.945 139.823 552.705 134.631 558.556 132.556C565.993 129.917 570.076 125.98 574 119.222C584.853 100.532 592.719 78.3596 586.944 56.2222C584.793 47.9761 582.701 40.3009 578 33.1111C571.482 23.1426 565.908 18.5395 555.611 12.6111C549.576 9.13625 544.234 9.04256 537.889 7.88889C531.474 6.72262 524.726 3 518.222 3C510.752 3 500.939 1.2243 494 4" stroke="white" stroke-width="3" stroke-linecap="round"/> -->
      </svg>
    </div>
    <div v-if="isLogined">
      <div class="top text-center text-capitalize" data-aos="fade-up" data-aos-delay="1500">
        <a href="/" class="navbar-brand d-flex">
    <img src="/logo_trans.png" width="23" loading="lazy" style="margin-top: -0px;" height="23" alt="">
    <h4 style="text-transform: none;margin-left: -3px;">age cord</h4>
  </a>
        <div class="text-capitalize">
        <button @click="logout" class="mx-1 btn btn-outline-success text-capitalize">Logout</button>
        <a href="/inbox" class="mx-1 btn btn-outline-primary text-capitalize">inbox</a>
      </div>
      </div>
      <div class="user" data-aos="fade-up">
        <h1 v-text="getNmae" class="text-center"></h1>
        <div class="grid">
          <a :href="'/' + page" class="cols" v-for="page in pages" :key="page">
            <h3>page:</h3>
            <h2>{{ page }}</h2>
          </a>
        </div>
        <div style="width: 70vw;" class="mt-5 d-flex justify-content-start ">
          <form @submit.prevent="addPage" class="form-inline w-100">
            <div class="input-group w-100">
              <label for="pager"></label>
              <input type="text"  id="pager" placeholder="Create A New Page" style="background-color: transparent;border: 0.5px solid #9b9b9b;border-radius: 7px; border-top-right-radius: 0px;border-bottom-right-radius: 0px;width: calc(70vw - 70px);" class="text-light p-2 px-3">
              <button class="btn btn-outline-primary ">Create</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div v-else>
      <nav data-aos="fade-up" class="navbar navbar-expand navbar-dark bg-dark">
        <a href="/" class="navbar-brand d-flex">
    <img src="/logo_trans.png" width="23" loading="lazy" style="margin-top: -0px;" height="23" alt="">
    <h4 style="text-transform: none;margin-left: -3px;">age cord</h4>
  </a>
        <ul class="smalls navbar-nav gap-2">
          <li class="nav-item ">
            <a class="nav-link" href="#">about us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">credits</a>
          </li>
          <li class="nav-item">
            <a class="btn btn-outline-light" href="#">donate</a>
          </li>
        </ul>
        <div class="d-flex gap-1">
          <a href="https://github.com/hasan-bro-coder" class="pop btn btn-outline-light ">
            <span class="d-flex gap-1"><svg style="width: 25px;margin-left: -5px;" class="" viewBox="0 0 17 16"
                xmlns="http://www.w3.org/2000/svg" fill="none">
                <path
                  d="M8.5 2.22168C5.23312 2.22168 2.58496 4.87398 2.58496 8.14677C2.58496 10.7642 4.27962 12.9853 6.63026 13.7684C6.92601 13.8228 7.03366 13.6401 7.03366 13.4827C7.03366 13.3425 7.02893 12.9693 7.02597 12.4754C5.38041 12.8333 5.0332 11.681 5.0332 11.681C4.76465 10.996 4.37663 10.8139 4.37663 10.8139C3.83954 10.4471 4.41744 10.4542 4.41744 10.4542C5.01072 10.4956 5.32303 11.0647 5.32303 11.0647C5.85065 11.9697 6.70774 11.7082 7.04431 11.5568C7.09873 11.1741 7.25134 10.9132 7.42051 10.7654C6.10737 10.6157 4.72621 10.107 4.72621 7.83683C4.72621 7.19031 4.95689 6.66092 5.33486 6.24686C5.27394 6.09721 5.07105 5.49447 5.39283 4.67938C5.39283 4.67938 5.88969 4.51967 7.01947 5.28626C7.502 5.15466 7.99985 5.08763 8.5 5.08692C9.00278 5.08929 9.50851 5.15495 9.98113 5.28626C11.1103 4.51967 11.606 4.67879 11.606 4.67879C11.9289 5.49447 11.7255 6.09721 11.6651 6.24686C12.0437 6.66092 12.2732 7.19031 12.2732 7.83683C12.2732 10.1129 10.8897 10.6139 9.5724 10.7606C9.78475 10.9434 9.97344 11.3048 9.97344 11.8579C9.97344 12.6493 9.96634 13.2887 9.96634 13.4827C9.96634 13.6413 10.0728 13.8258 10.3733 13.7678C11.5512 13.3728 12.5751 12.6175 13.3003 11.6089C14.0256 10.6002 14.4155 9.38912 14.415 8.14677C14.415 4.87398 11.7663 2.22168 8.5 2.22168Z"
                  fill="currentColor"></path>
              </svg>
              <div style="">57k</div>
            </span>
            <span style="margin: 20px 0px 0px -50px;" class="position-fixed tooltips">its fake btw</span>
          </a>
          <a href="/login" class="btn btn-outline-success text-capitalize">Login</a>
        </div>
      </nav>
      <div class="mid-start text-white">
        <h1 class="text-center" data-aos="zoom-in-right">i donno why i made</h1>
        <div class="mt-2"></div>
        <h1 class="text-center text-success" data-aos="zoom-in-right">page cord</h1>
        <div class="p" data-aos="fade-left">page cord is just made for fun. its not for serious works. we recommande
          discord for that ðŸ’€</div>
        <div class="my-3">
          <a href="/1" class="btn btn-outline-light mx-2 text-capitalize">open Page cord</a>
          <button v-if="isChrome" @click="installPWA" class="pop2 btn btn-outline-light mx-2 text-capitalize">install Page
            cord<span style="margin: 40px 0px 0px -100px;" class="position-fixed tooltips2">Pwa</span></button>
        </div>
      </div>
    </div>
  </div>
</template>
<script lang="js">
// import { createClient } from '@supabase/supabase-js'
import AOS from 'aos';
import 'aos/dist/aos.css'
import 'bootstrap/dist/css/bootstrap.css';
import { store } from '../store';
// import { v4 as uuidv4 } from 'uuid';
const supabase = store.supabase
// createClient('https://fvofzvyfqveudmkkbdqn.supabase.co', "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ2b2Z6dnlmcXZldWRta2tiZHFuIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTQ4NDcxODUsImV4cCI6MjAxMDQyMzE4NX0.CW5FbiNWTLDwdpw_ojtUWH5DHGOTBmZJZzhDqYRLpLA")

export default {
  data: () => ({
    shown: true,
    pages: ["page1"],
    data: [],
    isLogined: localStorage.getItem('login')
  }),

  beforeMount() {
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault()
      this.installEvent = e
      this.shown = true
    })
  },
  computed: {
    // isLogined() {
      // return localStorage.getItem('login')
    // },
    logout() {
      confirm('bro are you sure') ? localStorage.clear() : 0; location.reload()
    },
    getNmae() {
      return localStorage.getItem('dname') + " :"
    },
    isChrome() {
      return navigator.userAgent.indexOf('Chrome') > -1
    },
  },
  methods: {
    async addPage(){
      let val = document.querySelector("#pager").value.replace(" ","-").replace("/","-");
      {
      const { data, error } = await supabase
    .from('chat')
    .select('*')
    .eq("room_name",val)
    console.log(data);
    if(data.length > 0){
      alert("page allready exists")
      return 0
    }
      }
    let { v4 } = await import("uuid")
  const { dat, error } = await supabase
    .from('chat')
    .insert([
      { room_name: val, massage:"the first massage" ,room_id: v4()},
    ])
    .select()
    if (error) {
      error.message.match("duplicate key value") ? alert("page allready exists"):alert(error.message)
    }
    else{
      let { data, err } = await supabase
      .from('bros')
      .select('*')
      .eq("user_id", localStorage.getItem('token'))
      let arr = JSON.parse(data[0].pagees)
      arr.push(val)
      await supabase
    .from('bros')
    .update({ pagees: arr })
    .eq("user_id", localStorage.getItem('token'))
    .select()
    // {
    // let { data, err } = await supabase
    //   .from('bros')
    //   .select('*')
    //   .eq("name", localStorage.getItem('name'))
    //   let arr = JSON.parse(data[0].pages)
    //   arr.push(document.querySelector("#pager").value)
    //   await supabase
    // .from('bros') 
    // .update({ pages: arr })
    // .eq("name", localStorage.getItem('name'))
    // .select()
    // }
  }
  window.location.reload()
    },
    dismissPrompt() {
      window.location.pathname = '/1'
    },

    installPWA() {
      this.installEvent.prompt()
      this.installEvent.userChoice.then((choice) => {
        this.dismissPrompt() // Hide the prompt once the user's clicked
        if (choice.outcome === 'accepted') {
          // Do something additional if the user chose to install
        } else {
          // Do something additional if the user declined
        }
      })
    },
  },

  async mounted() {
    // localStorage.setItem('pages', JSON.stringify(['1','2','3']))
    // async function parse(){
    if (localStorage.getItem('login')) {
      let pages = ""
      let { data, error } = await supabase
        .from('bros')
        .select('*')
        .eq("user_id", localStorage.getItem('token'))
        if (error || data.length <= 0) {
          this.isLogined = false
          alert("Error in you login data bro")
          localStorage.clear()
          return 0 
        }
      this.pages = JSON.parse(data[0].pagees)
      this.data = data
    }

    // if (localStorage.getItem('login')) {
    //   document.getElementById('log').style.display = 'inline';
    // }
    const {gsap} = await import('gsap')
    gsap.to("body", { opacity: 1, });
    let load = gsap.timeline()
    load.to("path", { strokeDashoffset: 0, duration: 2, delay: 1, ease: "power1.out", });
    load.to('.loading', { duration: 1.5, "--clip": '0%' })
    // document.querySelector('form').addEventListener("submit",(e)=>{
    // e.preventDefault()
    // window.location.pathname=document.querySelector('#input').value
    // })
    let scroll = 0
    // window.onscroll =(e)=>{
    // scroll++

    // document.querySelector(".mid-start").style.translate = `0px ${scroll*4}px`
    // + e.SCROLL_PAGE_UP
    // `translateX(${e.SCROLL_PAGE_UP})`
    // }
  }
}
// var typed = new Typed(".type", {
//     strings: ["Bro", "Sis", "them", "coder"],
//     typeSpeed: 50,
//     loop: true,
//     cursorChar: '|',
//     // backDelay: 900,
//     // fadeOut: true,
//     // fadeOutClass: 'typed-fade-out',
//     // fadeOutDelay: 500,

//     backSpeed: 50,
//   });
AOS.init();
</script>

<style scoped lang="scss">
.body {
  background: rgb(28, 28, 28);
  // margin-top: 100vh;
  min-height: 200vh;
}

* {
  cursor: url("../assets/cursor3.png"), none;
  /* background-color: black; */
  margin: 0%;
  scrollbar-color: #30363b #000000;
  scrollbar-width: thin;
  scroll-behavior: smooth;
}
.btn-outline-primary {
--bs-btn-border-color: #0084ff;
--bs-btn-color: #0084ff;

}
.btn-outline-success {
--bs-btn-border-color: #0ac56e;
--bs-btn-color:#0ac56e;
}
.top {
  padding: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-left: 0.5px solid white;
  border-right: 0.5px solid white;
  border-bottom: 1px solid #2e2e2e;
  color: white;
}

.top-start h4 {
  margin-left: 30px;
}

.top-start .h6 {
  margin-left: -4vw;
}

.mid-start {
  margin-top: 70px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

.mid-start h1 {
  font-size: clamp(10px, 8vw, 70px);
  font-family: Circular, custom-font, Helvetica Neue, Helvetica, Arial, sans-serif;
}

body {
  height: 200vh;

}

.mid-start .p {
  font-family: 'gg sans';
  width: 70vw;
  text-align: center;
  margin: 20px !important;
  padding: 0px !important;
  font-size: 15px;
  margin-top: 10px;
}

.navbar-brand {
  text-decoration: none;
  font-size: 25px !important;
  /* padding: 0px 40px 0px 0px; */
}

.user {
  margin-top: 20px;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

.user h1 {
  /* text-transform: uppercase;
  background-image: linear-gradient(
    -225deg,
    #231557 0%,
    #44107a 29%,
    #ff1361 67%,
    #fff800 100%
  ); */
  background-size: auto auto;
  background-clip: border-box;
  background-size: 200% auto;
  color: #fff;
  background-clip: text;
  /* text-fill-color: transparent; */
  -webkit-background-clip: text;
  /* -webkit-text-fill-color: transparent; */
  /* animation: textclip 2s linear infinite; */
}

@keyframes textclip {
  to {
    background-position: 200% center;
  }
}

.grid {
  transition: 1s;
  margin-top: 40px;
  display: grid;
  gap: 20px;
  width: 70vw;
  grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
}

.cols {
  display: flex;
  gap: 10px;
  color: rgb(237, 237, 237);
  transition: 500ms;
  border-radius: 10px;
  aspect-ratio: 1/0.8;
  border: 1px solid #2e2e2e;
  background-color: #232323;
  font-size: 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  object-fit: cover;
  flex-direction: column;
  text-decoration: none;
}

.cols:hover {
  color: rgb(255, 255, 255);
  transition: 500ms;
  border-radius: 10px;
  border: 1px solid #9b9b9b;
  background-color: #363636;
  margin-top: -20px;
}

.cols:hover h2 {
  transition: 100ms;
  font-size: 21px;

}
.cols h2 {
  // transition: 100ms;
  font-size: 19px;

}


.bg {
  position: fixed;
  z-index: -20;
  top: 0;
  left: 0;
}

.tooltips {
  opacity: 0;
  display: none;
  transition: 1s;
  background-color: #181818;
  border-top: 1px solid white;
  border-radius: 5px;
  // border-top-right-radius: 10px;
  // border-top-left-radius: 10px;
  padding: 10px;
}

a.pop:hover .tooltips {
  transition: all 1s;
  display: inline !important;
  opacity: 1;
  color: white;
}

.tooltips2 {
  opacity: 0;
  display: none;
  transition: 1s;
  background-color: #181818;
  border-top: 1px solid white;
  border-radius: 5px;
  // border-top-right-radius: 10px;
  // border-top-left-radius: 10px;
  padding: 10px;
}

.pop2:hover .tooltips2 {
  transition: all 1s;
  display: inline !important;
  opacity: 1;
  color: #3ecf96;
}

.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 40px;
}

.bg-dark {
  background-color: #27272700 !important;
}

.text-success {
  /* color: #3ecf96 !important; */
  text-shadow: 0 0 1px #3ecf96, 0 0 0px #3ecf96;
  // text-fill-color: transparent;
  -webkit-text-fill-color: transparent;
}

h1.col span:not(.typed-cursor) {
  background: rgb(58, 165, 180);
  background: linear-gradient(286deg, rgba(58, 165, 180, 1) 0%, rgba(54, 29, 253, 1) 27%, rgba(157, 69, 252, 1) 54%);
  /* background: -webkit-linear-gradient(90deg, rgba(131,58,180,1) 0%, rgba(253,29,29,1) 50%, rgba(252,176,69,1) 100%); */
  // -webkit-background-clip: text;
  // -webkit-text-fill-color: transparent;
}

@media (max-width: 768px) {
  h1.col {
    font-size: 10vw
  }

  .smalls {
    display: none;
  }
  .navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 10px;
}
  .cols h3 {
    display: none;
  }
}

.loading {
  background-color: black;
  --clip: 130%;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  animation: load 1s 1;
  -webkit-clip-path: circle(var(--clip) at 50% 5%);
  clip-path: circle(var(--clip) at 50% 5%);
}

.loading path {
  stroke-dasharray: 400;
  stroke-dashoffset: 400;
}

.loading svg {
  width: clamp(400px, 40vw, 500px);
  height: auto;
}

::-webkit-scrollbar {
  width: 5px;
}

/* Track */
::-webkit-scrollbar-track {
  /* box-shadow: inset 0 0 5px grey; */
  background-color: #000000;
  border-radius: 10px;
}

/* Handle */
::-webkit-scrollbar-thumb {
  background: #30363b;
  border-radius: 10px;
}</style>